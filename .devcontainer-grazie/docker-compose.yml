services:
  app:
    build:
      context: ..
      dockerfile: .devcontainer-grazie/Dockerfile
      platforms:
        - linux/amd64

    # Publish ports for Grazie chat (8000), Agent service (8001), and IDE (8080)
    ports:
      - "8000:8000"
      - "8001:8001"
      - "8080:8080"

    volumes:
      - ..:/workspace:cached

    command: sleep infinity

    environment:
      PYTHONPATH: /workspace
      WORKSPACE_ROOT: /workspace
      GRAZIE_API_TOKEN: ${GRAZIE_API_TOKEN:-}
      GRAZIE_ENVIRONMENT: ${GRAZIE_ENVIRONMENT:-PREPROD}
