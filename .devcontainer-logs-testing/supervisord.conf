[supervisord]
nodaemon=true
user=root
logfile=/dev/stdout
logfile_maxbytes=0
pidfile=/var/run/supervisord.pid
# Send all logs to stdout for orca-worker to capture
loglevel=info

[program:unified-service-8000]
command=node /opt/unified-service/server.js
directory=/opt/unified-service
autostart=true
autorestart=true
startretries=3
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=PORT="8000"

[program:unified-service-8001]
command=node /opt/unified-service/server.js
directory=/opt/unified-service
autostart=true
autorestart=true
startretries=3
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=PORT="8001"

[program:code-server]
command=code-server --bind-addr 0.0.0.0:8080 --auth none --disable-telemetry --disable-update-check --disable-workspace-trust /workspaces/orca-test-jcp-ai-workloads
autostart=true
autorestart=true
startretries=3
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:test-runner]
command=/opt/logs-testing/run-test.sh
directory=/workspaces/orca-test-jcp-ai-workloads
autostart=true
autorestart=false
startsecs=0
startretries=0
exitcodes=0,1
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
# Test script is set via environment variable at container startup
